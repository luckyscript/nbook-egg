<%- include ./components/header.ejs%>
  <div class="wrap">
    <div class="container">
      <aside class="aside about-aside">
        <div class="my-info">
          <h3>About Me</h3>
          <div>
            <img class="my-photo" src="https://tvax3.sinaimg.cn/crop.0.0.568.568.180/005Q8srJly8g113pud0g2j30fs0fsdgv.jpg">
          </div>
          <div>
            <h2 style="margin-top: 20px;">Luckyscript</h2>
            <h5>这里空白太小，我写不下</h5>
          </div>
          <ul>
            <li>
              <i class="fa fa-weibo"></i>
              <a target="_blank" nofollow href="https://weibo.com/luckyscript">weibo</a>
            </li>
            <li>
              <i class="fa fa-github"></i>
              <a target="_blank" nofollow href="https://github.com/luckyscript">github</a>
            </li>
            <li>
              <i class="fa fa-steam"></i>
              <a target="_blank" nofollow href="https://steamcommunity.com/profiles/76561198108666682/">steam</a>
            </li>
            <li>
              <i class="fa fa-envelope"></i>
              <a target="_blank" nofollow href="mailto:main.lukai@gmail.com">email</a>
            </li>
            <li>
              <i class="fa fa-telegram"></i>
              <a target="_blank" nofollow href="https://t.me/luckyscript">telegram</a>
            </li>
            <li>
              <i class="fa fa-instagram"></i>
              <a target="_blank" nofollow href="https://www.instagram.com/luckyscript/">instagram</a>
            </li>
            <li>
              <i class="fa fa-youtube-play"></i>
              <a target="_blank" nofollow href="https://www.youtube.com/channel/UC2Lqp5xsopa3MMnf9VmY_SQ">Youtube</a>
            </li>
            <li>
              <i class="fa fa-medium"></i>
              <a target="_blank" nofollow href="https://www.youtube.com/channel/UC2Lqp5xsopa3MMnf9VmY_SQ">Medium</a>
            </li>
          </ul>
        </div>
      </aside>
      <article class="article about-container">
        <div class="post-content">
          <%-about.markdown.html%>
        </div>
      <%- include ./components/comments.ejs%>
      </article>
    </div>
  </div>
</body>
<script src="//apps.bdimg.com/libs/jquery/1.9.1/jquery.js"></script>
<script>
const cookieObject = document.cookie.split(';').reduce((result, current) => {
    const [,key, value] = /(.+)=(.+)/.exec(current.trim());
    result[key] = value;
    return result;
  }, {});
  const csrfToken = cookieObject['csrfToken'];
  window.pid = null;
  function reply(id, name) {
    const commentTextarea = document.querySelector('#comment-content');
    window.pid = id;
    if (commentTextarea.value.search(`@${name}`) === -1) {
      commentTextarea.value = `@${name} ` + commentTextarea.value ;
    }
    commentTextarea.focus();
  }

  const submitBtn = document.querySelector('#submit-comment');
  const formNode = document.querySelector('#comment-form');
  submitBtn.addEventListener('click', () => {
    // TODO 表单校验
    const formdata = new FormData(formNode);
    const content = formdata.get('content');
    const name = formdata.get('name');
    const email = formdata.get('email');
    const site = formdata.get('site');
    $.ajax({
      url: '/about/comment',
      type: 'POST',
      headers: {
        'x-csrf-token': csrfToken,
      },
      dataType: 'json',
      data: {
        pid: window.pid,
        content,
        name,
        email,
        site,
        type: 'about',
      },
      success: function (data) {
        if (data && data.success) {

        }
      }
    });
  })
</script>
<%- include footer.html%>
